define(["jquery","core/ajax","core/notification"],function(a,b,c){var d=function(b,c){this._region=a(b),this._visioid=c,this._presence=[],this._checkboxes=a(b).find("tbody").find("tr").find('[data-element="visio-checkbox"]'),this._checkboxes.on("click",this._toggleUserPresence.bind(this)),this._getUsersPresence()};return d.prototype._getUsersPresence=function(){b.call([{methodname:"mod_visio_get_presence",args:{visioid:this._visioid},done:function(a){this._presence=a,this._setPresenceInTable()}.bind(this),fail:c.exception}])},d.prototype._setPresenceInTable=function(){var a=this._region.find("tbody").find("tr");this._presence.forEach(function(b){var c=a.find('[data-element="visio-checkbox"][value='+b.userid+"]");c&&1==b.value?c.prop("indeterminate",!0):c&&2==b.value?c.prop("checked",!0):c.prop("checked",!1)})},d.prototype._toggleUserPresence=function(b){var c=b.currentTarget;a(c).val()&&this._attestUserPresence(a(c).val(),a(c).prop("checked"))},d.prototype._attestUserPresence=function(a,d){b.call([{methodname:"mod_visio_set_presence",args:{visioid:this._visioid,userid:a,value:1==d?2:0},done:function(){return!0},fail:c.exception}])},d});